{"version":3,"sources":["../../src/index.tsx","../../src/typeDefs.ts","../../src/useInjectScript.tsx","components/Accounts.js","components/Buckets.js","components/Reload.js","App.js","index.js"],"names":["mod","exports","react_1","require","typeDefs_1","useInjectScript_1","_f","picker","defaultScopes","_a","default","loaded","error","_b","pickerApiLoaded","_c","setpickerApiLoaded","_d","_g","useEffect","loadedGsi","loadApis","openAfterAuth","load","callback","token","disabled","_e","showUploadView","showUploadFolders","config","setConfig","oauth2","initTokenClient","scope","customScopes","join","createPicker","__assign","tokenResponse","injectorState","url","state","job","injectorMap","src","onScriptEvent","addEventListener","setState","Accounts","accounts","currency","budgetAccounts","filter","a","offBudgetAccounts","Accordion","defaultActiveKey","alwaysOpen","Item","eventKey","Header","Body","Table","striped","hover","bordered","map","account","format","Buckets","buckets","bucketCats","Array","from","entries","cat","i","values","bucket","Reload","accessToken","setAccessToken","handleReload","Promise","resolve","reject","document","querySelector","script","createElement","onload","onerror","err","body","appendChild","then","window","google","client_id","process","access_token","requestAccessToken","Button","variant","onClick","App","useState","db","setDb","useDrivePicker","openPicker","authResponse","fileId","setFileId","fileSize","setFileSize","setBuckets","setBucketCats","setAccounts","view","setView","lastUpdated","setLastUpdated","reloadToken","setReloadToken","downloadProgress","setDownloadProgress","setError","Intl","NumberFormat","style","handleOpenPicker","clientId","developerKey","viewId","supportDrives","multiselect","viewMimeTypes","viewQuery","callbackFunction","data","action","console","log","docs","sizeBytes","id","localStorage","setItem","getFile","headers","Authorization","responseType","onDownloadProgress","progressEvent","Math","floor","axios","get","catch","e","message","clear","response","uInt8Array","Uint8Array","initSqlJs","locateFile","file","SQL","Database","newBuckets","exec","reduce","entryMap","set","Map","JSON","stringify","newBucketCats","newAccounts","Date","toString","getItem","parse","Alert","height","className","textAlign","size","Navbar","bg","Container","Brand","color","position","bottom","Tabs","activeKey","onSelect","k","Tab","title","href","createRoot","getElementById","render"],"mappings":"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","file":"static/js/main.94259df8.chunk.js","sourcesContent":[null,null,null,"import { Accordion, Table } from 'react-bootstrap'\n\nconst Accounts = ({ accounts, currency }) => {\n  const budgetAccounts = accounts.filter((a) => a[3] !== 'offbudget')\n  const offBudgetAccounts = accounts.filter((a) => a[3] === 'offbudget')\n\n  return (\n    <Accordion defaultActiveKey={[0]} alwaysOpen>\n      <Accordion.Item eventKey={0}>\n        <Accordion.Header>Budget Accounts</Accordion.Header>\n        <Accordion.Body>\n          <Table striped hover bordered>\n            <tbody>\n              <tr>\n                <th>Name</th>\n                <th>Balance</th>\n              </tr>\n              {budgetAccounts.map((account) => (\n                <tr key={account[0]}>\n                  <td>{account[1]}</td>\n                  <td>{currency.format(account[2] / 100.0)}</td>\n                </tr>\n              ))}\n            </tbody>\n          </Table>\n        </Accordion.Body>\n      </Accordion.Item>\n      <Accordion.Item eventKey={1}>\n        <Accordion.Header>Off Budget Accounts</Accordion.Header>\n        <Accordion.Body>\n          <Table striped hover bordered>\n            <tbody>\n              <tr>\n                <th>Name</th>\n                <th>Balance</th>\n              </tr>\n              {offBudgetAccounts.map((account) => (\n                <tr key={account[0]}>\n                  <td>{account[1]}</td>\n                  <td>{currency.format(account[2] / 100.0)}</td>\n                </tr>\n              ))}\n            </tbody>\n          </Table>\n        </Accordion.Body>\n      </Accordion.Item>\n    </Accordion>\n  )\n}\n\nexport default Accounts\n","import { Accordion, Table } from 'react-bootstrap'\n\nconst Buckets = ({ buckets, bucketCats, currency }) => {\n  return (\n    <Accordion defaultActiveKey={[]} alwaysOpen>\n      {Array.from(buckets.entries()).map((cat, i) => {\n        return (\n          <Accordion.Item eventKey={i} key={i}>\n            <Accordion.Header>\n              {bucketCats.values[cat[0] - 1]\n                ? bucketCats.values[cat[0] - 1][1]\n                : 'Misc'}\n            </Accordion.Header>\n            <Accordion.Body>\n              <Table striped hover bordered>\n                <tbody>\n                  <tr>\n                    <th>Name</th>\n                    <th>Balance</th>\n                  </tr>\n\n                  {cat[1].map((bucket) => (\n                    <tr key={bucket[0]}>\n                      <td>{bucket[1]}</td>\n                      <td>{currency.format(bucket[2] / 100.0)}</td>\n                    </tr>\n                  ))}\n                </tbody>\n              </Table>\n            </Accordion.Body>\n          </Accordion.Item>\n        )\n      })}\n    </Accordion>\n  )\n}\n\nexport default Buckets\n","import { ArrowClockwise } from 'react-bootstrap-icons'\nimport { Button } from 'react-bootstrap'\n\nconst Reload = ({ accessToken, setAccessToken }) => {\n  const loadScript = (src) =>\n    new Promise((resolve, reject) => {\n      if (document.querySelector(`script[src=\"${src}\"]`)) return resolve()\n      const script = document.createElement('script')\n      script.src = src\n      script.onload = () => resolve()\n      script.onerror = (err) => reject(err)\n      document.body.appendChild(script)\n    })\n\n  const handleReload = () => {\n    loadScript('https://accounts.google.com/gsi/client').then(() => {\n      const google = window.google\n      const client = google.accounts.oauth2.initTokenClient({\n        client_id: process.env.REACT_APP_CLIENT_ID,\n        scope: 'https://www.googleapis.com/auth/drive.file',\n        callback: (tokenResponse) => {\n          setAccessToken(tokenResponse.access_token)\n        }\n      })\n\n      client.requestAccessToken()\n    })\n  }\n\n  return (\n    <Button variant=\"light\" onClick={() => handleReload()}>\n      <ArrowClockwise /> Reload\n    </Button>\n  )\n}\n\nexport default Reload\n","import { useEffect, useState } from 'react'\nimport useDrivePicker from './react-google-drive-picker'\nimport axios from 'axios'\nimport initSqlJs from 'sql.js'\nimport Accounts from './components/Accounts'\nimport Buckets from './components/Buckets'\nimport Reload from './components/Reload'\nimport { Container, Tab, Tabs, Navbar, Button, Alert } from 'react-bootstrap'\nimport { Bucket, FileEarmarkText } from 'react-bootstrap-icons'\nimport './App.css'\n\nfunction App() {\n  const [db, setDb] = useState(null)\n  const [openPicker, authResponse] = useDrivePicker()\n  const [fileId, setFileId] = useState(null)\n  const [fileSize, setFileSize] = useState(null)\n  const [buckets, setBuckets] = useState(null)\n  const [bucketCats, setBucketCats] = useState(null)\n  const [accounts, setAccounts] = useState(null)\n  const [view, setView] = useState('buckets')\n  const [lastUpdated, setLastUpdated] = useState(null)\n  const [reloadToken, setReloadToken] = useState(null)\n  const [downloadProgress, setDownloadProgress] = useState(0)\n  const [error, setError] = useState(null)\n\n  const currency = new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD'\n  })\n\n  // Use Google Drive Picker\n  const handleOpenPicker = () => {\n    openPicker({\n      clientId: process.env.REACT_APP_CLIENT_ID,\n      developerKey: process.env.REACT_APP_DEVELOPER_KEY,\n      viewId: 'DOCS',\n      // token: localStorage.getItem('auth') || null, // pass oauth token in case you already have one\n      showUploadView: true,\n      showUploadFolders: true,\n      supportDrives: true,\n      multiselect: true,\n      viewMimeTypes: 'application/octet-stream',\n      viewQuery: '*.buckets',\n      customScopes: ['https://www.googleapis.com/auth/drive.file'],\n      callbackFunction: (data) => {\n        if (data.action === 'cancel') {\n          console.log('User clicked cancel/close button')\n        }\n        if (data.action === 'picked') {\n          setFileSize(data.docs[0].sizeBytes)\n          setFileId(data.docs[0].id)\n          localStorage.setItem('fileId', data.docs[0].id)\n        }\n      }\n    })\n  }\n\n  //If we have an auth token, load the DB from Google Drive\n  useEffect(() => {\n    if ((authResponse || reloadToken) && fileId) {\n      setError(null)\n      const token = authResponse ? authResponse.access_token : reloadToken\n      const getFile = async () => {\n        const config = {\n          headers: {\n            Authorization: `Bearer ${token}`,\n            'Content-Type': 'application/x-sqlite3'\n          },\n          responseType: 'arraybuffer',\n          onDownloadProgress: (progressEvent) => {\n            setDownloadProgress(\n              Math.floor((progressEvent.loaded / fileSize) * 100)\n            )\n          }\n        }\n        const response = await axios\n          .get(\n            `https://www.googleapis.com/drive/v3/files/${fileId}?alt=media&supportsAllDrives=true`,\n            config\n          )\n          .catch((e) => {\n            setError(e.message)\n            setFileId(null)\n            setBuckets(null)\n            localStorage.clear()\n          })\n        const uInt8Array = new Uint8Array(response.data)\n        const SQL = await initSqlJs({\n          locateFile: (file) => `https://sql.js.org/dist/${file}`\n        })\n        setDb(new SQL.Database(uInt8Array))\n      }\n      localStorage.setItem('fileId', fileId)\n      getFile()\n    }\n  }, [authResponse, reloadToken, fileId, fileSize])\n\n  //DB Queries - Saved to Local Storage and State\n  useEffect(() => {\n    if (db) {\n      try {\n        const newBuckets = db\n          .exec(\n            'SELECT id, name, balance, group_id FROM bucket WHERE kicked = 0'\n          )[0]\n          .values.reduce(\n            (entryMap, e) =>\n              entryMap.set(e[3], [...(entryMap.get(e[3]) || []), e]),\n            new Map()\n          )\n        setBuckets(newBuckets)\n        localStorage.setItem('buckets', JSON.stringify(Array.from(newBuckets)))\n\n        const newBucketCats = db.exec('SELECT id, name FROM bucket_group')[0]\n        setBucketCats(newBucketCats)\n        localStorage.setItem('bucketCats', JSON.stringify(newBucketCats))\n\n        const newAccounts = db.exec(\n          'SELECT id, name, balance, kind FROM account WHERE closed = 0'\n        )[0].values\n        setAccounts(newAccounts)\n        localStorage.setItem('accounts', JSON.stringify(newAccounts))\n\n        setLastUpdated(new Date())\n        localStorage.setItem('lastUpdated', JSON.stringify(new Date()))\n      } catch (e) {\n        setError(e.toString())\n        setFileId(null)\n        setBuckets(null)\n        setDb(null)\n        localStorage.clear()\n      }\n    }\n  }, [db])\n\n  //Retrieve Data from Local Storage\n  useEffect(() => {\n    if (localStorage.getItem('buckets')) {\n      setBuckets(new Map(JSON.parse(localStorage.getItem('buckets'))))\n    }\n    if (localStorage.getItem('bucketCats')) {\n      setBucketCats(JSON.parse(localStorage.getItem('bucketCats')))\n    }\n    if (localStorage.getItem('accounts')) {\n      setAccounts(JSON.parse(localStorage.getItem('accounts')))\n    }\n    if (localStorage.getItem('lastUpdated')) {\n      setLastUpdated(new Date(JSON.parse(localStorage.getItem('lastUpdated'))))\n    }\n    if (localStorage.getItem('fileId')) {\n      setFileId(localStorage.getItem('fileId'))\n    }\n  }, [])\n\n  if (!fileId || error) {\n    return (\n      <>\n        {error ? <Alert variant=\"danger\">{error}</Alert> : null}\n        <div\n          style={{ height: '100vh' }}\n          className=\"d-flex align-items-center justify-content-center\"\n        >\n          <div style={{ textAlign: 'center' }}>\n            <Button\n              size=\"lg\"\n              variant=\"primary\"\n              onClick={() => handleOpenPicker()}\n            >\n              Select Budget\n            </Button>\n            <br />\n            <br />\n            <p>\n              Welcome to Buckets Viewer. Use the button to select your .buckets\n              file from Google Drive.\n            </p>\n          </div>\n        </div>\n      </>\n    )\n  }\n\n  if (!buckets || !bucketCats || !accounts) {\n    return (\n      <div\n        style={{ height: '100vh', textAlign: 'center' }}\n        className=\"d-flex align-items-center justify-content-center\"\n      >\n        Loading {downloadProgress}%\n      </div>\n    )\n  }\n\n  return (\n    <div>\n      <Navbar bg=\"dark\" variant=\"dark\">\n        <Container>\n          <Navbar.Brand>\n            <Bucket color=\"white\" style={{ position: 'relative', bottom: 2 }} />{' '}\n            Buckets Viewer\n          </Navbar.Brand>\n          <div style={{ textAlign: 'right' }}>\n            <Reload accessToken={reloadToken} setAccessToken={setReloadToken} />{' '}\n            <Button variant=\"light\" onClick={() => handleOpenPicker()}>\n              <FileEarmarkText /> Select New File\n            </Button>\n          </div>\n        </Container>\n      </Navbar>\n      <Container>\n        <br />\n        <br />\n        <Tabs activeKey={view} onSelect={(k) => setView(k)}>\n          <Tab eventKey=\"buckets\" title=\"Buckets\">\n            <Buckets\n              buckets={buckets}\n              bucketCats={bucketCats}\n              currency={currency}\n            />\n          </Tab>\n          <Tab eventKey=\"accounts\" title=\"Accounts\">\n            <Accounts accounts={accounts} currency={currency} />\n          </Tab>\n        </Tabs>\n        <div className=\"footer\">\n          {lastUpdated ? (\n            <p>\n              <br />\n              Last loaded {lastUpdated.toString()}\n            </p>\n          ) : null}\n          <p>\n            &copy;2022 Dustin Lammiman.{' '}\n            <a href=\"privacy.html\">Privacy Policy</a>. This website is not\n            associated with One Part Rain, LLC.\n          </p>\n        </div>\n      </Container>\n    </div>\n  )\n}\n\nexport default App\n","import React from 'react'\nimport App from './App'\nimport { createRoot } from 'react-dom/client'\n\ncreateRoot(document.getElementById('root')).render(<App />)\n"],"sourceRoot":""}